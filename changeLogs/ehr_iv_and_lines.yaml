# Author: Charlize Aponte
# Date: November 16, 2024
# Remarks: This change log defines the tables needed for the EHR application for IV and lines.

databaseChangeLog:
  - changeSet:
      id: 2
      author: charlize-apo
      changes:
        - createTable:
            tableName: iv_and_lines
            columns:
              - column:
                  name: id
                  type: VARCHAR(36)
                  constraints:
                    primaryKey: true
                    nullable: false
                    primaryKeyName: iv_and_lines_primary_key
              - column:
                  name: patient_id
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
              - column:
                  name: iv_type
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: size
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: location
                  type: VARCHAR(250)
                  constraints:
                    nullable: false
              - column:
                  name: fluid_or_med_name
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: fluid_or_med_rate
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: patent
                  type: BOOLEAN
                  constraints:
                    nullable: false
              - column:
                  name: is_clinical_documentation_improvement
                  type: BOOLEAN
                  constraints:
                    nullable: false
              - column:
                  name: created_by
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: created_date
                  type: TIMESTAMP
                  defaultValueComputed: "NOW()"
                  constraints:
                    nullable: false
              - column:
                  name: modified_by
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: modified_date
                  type: TIMESTAMP
                  defaultValueComputed: "NOW()"
                  constraints:
                    nullable: false

        - addForeignKeyConstraint:
            constraintName: iv_and_lines_patient_id_fk
            baseColumnNames: patient_id
            baseTableName: iv_and_lines
            referencedTableName: patient
            referencedColumnNames: id
            onDelete: CASCADE

        - addDefaultValue:
            columnName: id
            tableName: iv_and_lines
            defaultValueComputed: "UUID()"

